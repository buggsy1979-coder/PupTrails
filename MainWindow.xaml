<Window x:Class="PupTrailsV3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PupTrail - Animal Rescue Management System" Height="800" Width="1200" WindowStartupLocation="CenterScreen" Background="{StaticResource DarkBackground}" WindowState="Normal">
    <DockPanel>
        <!-- Header with Gradient -->
            <Border DockPanel.Dock="Top" Height="70" Padding="20,0">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#0D47A1" Offset="0"/>
                        <GradientStop Color="#1565C0" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="4" Opacity="0.5" Color="#000000"/>
                </Border.Effect>
                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="üêæ PupTrail" FontSize="32" FontWeight="Bold" Foreground="White" Margin="0,0,20,0"/>
                        <TextBlock Text="Animal Rescue Management System" FontSize="16" Foreground="#E0E0E0" VerticalAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Content="üì§ Master Export" Click="MasterExport_Click" Background="#4CAF50" Foreground="White" Padding="15,10" FontSize="13" FontWeight="Bold" Cursor="Hand" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="üì¶ Group Export" Click="GroupExport_Click" Background="#26A69A" Foreground="White" Padding="15,10" FontSize="13" FontWeight="Bold" Cursor="Hand" BorderThickness="0" Margin="0,0,10,0"/>
                        <Button Content="‚úñ Close" Click="Close_Click" Background="#D32F2F" Foreground="White" Padding="20,10" FontSize="13" FontWeight="Bold" Cursor="Hand" BorderThickness="0"/>
                    </StackPanel>
                </Grid>
            </Border>
        
            <!-- Main Content -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
            
                <!-- Sidebar Navigation -->
                <Border Grid.Column="0" Background="{StaticResource DarkCardBackground}" BorderThickness="0,0,1,0" BorderBrush="{StaticResource DarkBorder}" Padding="0">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="15">
                            <TextBlock Text="MENU" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SecondaryText}" Margin="0,0,0,15" Opacity="0.8"/>
                            <Button Tag="Dashboard" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#1976D2" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üìä Dashboard</Button>
                            <Button Tag="Animals" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="{StaticResource AccentGreen}" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üêï Animals</Button>
                            <Button Tag="Puppies" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#FF6B9D" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">ÔøΩ Inventory</Button>
                            <Button Tag="People" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="{StaticResource AccentBlue}" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üë• People</Button>
                            <Button Tag="VetVisits" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#E91E63" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üè• Vet Visits</Button>
                            <Button Tag="Adoptions" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#9C27B0" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">‚ù§Ô∏è Adoptions</Button>
                            <Button Tag="Intake" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#00BCD4" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üì• Intake</Button>
                            <Button Tag="Expenses" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#FF5722" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üí∏ Expenses</Button>
                            <Button Tag="Income" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#4CAF50" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üí∞ Income</Button>
                            <Button Tag="MoneyOwed" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#FFC107" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üí≥ Money Owed</Button>
                            <Button Tag="Reports" Click="NavButton_Click" Padding="14,12" Margin="0,4" Background="#607D8B" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üìà Reports</Button>
                            <Separator Margin="0,10" Background="{StaticResource DarkBorder}"/>
                            <Button Click="AdvancedSearch_Click" Padding="14,12" Margin="0,4" Background="#03A9F4" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üîç Advanced Search</Button>
                            <Separator Margin="0,10" Background="{StaticResource DarkBorder}"/>
                            <TextBlock Text="SOCIAL MEDIA" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SecondaryText}" Margin="0,5,0,10" Opacity="0.8"/>
                            <Button Click="ExportFacebook_Click" Padding="14,12" Margin="0,4" Background="#1877F2" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üìò Social media exports</Button>
                            <Separator Margin="0,10" Background="{StaticResource DarkBorder}"/>
                            <TextBlock Text="DATABASE" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SecondaryText}" Margin="0,5,0,10" Opacity="0.8"/>
                            <Button Click="BackupDatabase_Click" Padding="14,12" Margin="0,4" Background="#2E7D32" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üíæ Backup Database</Button>
                            <Button Click="RestoreDatabase_Click" Padding="14,12" Margin="0,4" Background="#F57C00" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üìÇ Restore Database</Button>
                            <Separator Margin="0,10" Background="{StaticResource DarkBorder}"/>
                            <TextBlock Text="LICENSE" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SecondaryText}" Margin="0,5,0,10" Opacity="0.8"/>
                            <Button Click="LicenseInfo_Click" Padding="14,12" Margin="0,4" Background="#673AB7" HorizontalContentAlignment="Left" BorderThickness="0" Foreground="White" FontSize="13" FontWeight="SemiBold">üîë License Info</Button>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            
                <!-- Content Area -->
                <Border Grid.Column="1" Background="{StaticResource DarkBackground}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="25">
                        <!-- Dashboard View -->
                        <StackPanel x:Name="DashboardView" Visibility="Visible">
                            <TextBlock Text="Dashboard" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,25" Foreground="{StaticResource PrimaryText}"/>
                            
                            <!-- Statistics Cards -->
                            <Grid Margin="0,0,0,30">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Border Background="{StaticResource DarkCardBackground}" CornerRadius="10" Padding="25" Margin="0,0,12,0" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                            <StackPanel>
                                                <TextBlock Text="Animals in Care" FontSize="12" Foreground="{StaticResource SecondaryText}" FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding AnimalsInCare}" FontSize="36" FontWeight="Bold" Foreground="{StaticResource AccentGreen}" Margin="0,8,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Grid.Column="1" Background="{StaticResource DarkCardBackground}" CornerRadius="10" Padding="25" Margin="6,0,6,0" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                            <StackPanel>
                                                <TextBlock Text="Ready for Adoption" FontSize="12" Foreground="{StaticResource SecondaryText}" FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding AnimalsReadyForAdoption}" FontSize="36" FontWeight="Bold" Foreground="{StaticResource AccentOrange}" Margin="0,8,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Grid.Column="2" Background="{StaticResource DarkCardBackground}" CornerRadius="10" Padding="25" Margin="6,0,6,0" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                            <StackPanel>
                                                <TextBlock Text="Total Adopted" FontSize="12" Foreground="{StaticResource SecondaryText}" FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding AnimalsAdopted}" FontSize="36" FontWeight="Bold" Foreground="#4CAF50" Margin="0,8,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Grid.Column="3" Background="{StaticResource DarkCardBackground}" CornerRadius="10" Padding="25" Margin="12,0,0,0" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                            <StackPanel>
                                                <TextBlock Text="Monthly Profit/Loss" FontSize="12" Foreground="{StaticResource SecondaryText}" FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding MonthlyProfit, StringFormat=C}" FontSize="36" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" Margin="0,8,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                    
                                    <!-- Quick Actions Section -->
                                    <StackPanel Margin="0,0,0,30">
                                        <TextBlock Text="Quick Access" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                                        
                                        <!-- Row 1 -->
                                        <Grid Margin="0,0,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <Button Tag="Animals" Click="NavButton_Click" Background="{StaticResource AccentGreen}" Foreground="White" Padding="20,25" Margin="0,0,12,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üêï" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Animals" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="1" Tag="Puppies" Click="NavButton_Click" Background="#FF6B9D" Foreground="White" Padding="20,25" Margin="6,0,6,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="ÔøΩ" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Inventory" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="2" Tag="People" Click="NavButton_Click" Background="{StaticResource AccentBlue}" Foreground="White" Padding="20,25" Margin="6,0,6,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üë•" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="People" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            

                                            
                                            <Button Grid.Column="3" Tag="VetVisits" Click="NavButton_Click" Background="#E91E63" Foreground="White" Padding="20,25" Margin="12,0,0,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üè•" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Vet Visits" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </Grid>
                                        
                                        <!-- Row 2 -->
                                        <Grid Margin="0,0,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <Button Tag="Adoptions" Click="NavButton_Click" Background="#9C27B0" Foreground="White" Padding="20,25" Margin="0,0,12,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="‚ù§Ô∏è" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Adoptions" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="1" Tag="Intake" Click="NavButton_Click" Background="#00BCD4" Foreground="White" Padding="20,25" Margin="6,0,6,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üì•" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Intake" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="2" Tag="Expenses" Click="NavButton_Click" Background="#FF5722" Foreground="White" Padding="20,25" Margin="6,0,6,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üí∏" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Expenses" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="3" Tag="Income" Click="NavButton_Click" Background="#4CAF50" Foreground="White" Padding="20,25" Margin="12,0,0,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üí∞" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Income" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </Grid>
                                        
                                        <!-- Row 3 -->
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <Button Tag="MoneyOwed" Click="NavButton_Click" Background="#FFC107" Foreground="White" Padding="20,25" Margin="0,0,12,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üí≥" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Money Owed" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="1" Tag="Reports" Click="NavButton_Click" Background="#607D8B" Foreground="White" Padding="20,25" Margin="6,0,6,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üìà" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Reports" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="2" Click="AdvancedSearch_Click" Background="#3F51B5" Foreground="White" Padding="20,25" Margin="6,0,6,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üîç" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="Advanced Search" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Grid.Column="3" Tag="People" Click="NavButton_Click" Background="{StaticResource AccentBlue}" Foreground="White" Padding="20,25" Margin="12,0,0,0" FontSize="14" FontWeight="SemiBold" Cursor="Hand" BorderThickness="0">
                                                <StackPanel>
                                                    <TextBlock Text="üë•" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                    <TextBlock Text="People" HorizontalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </Grid>
                                    </StackPanel>
                        </StackPanel>

                        <!-- Animals View -->
                        <StackPanel x:Name="AnimalsView" Visibility="Collapsed">
                            <TextBlock Text="Animals" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,18">
                                <Button Content="‚ûï Add New Animal" Click="AddAnimal_Click" Background="{StaticResource AccentGreen}" Foreground="White" Padding="12,10" Width="160" HorizontalAlignment="Left" Margin="0,0,10,0" FontSize="13" FontWeight="SemiBold"/>
                                <Button Content="üóÇÔ∏è Add/Manage Groups" Click="ManageGroups_Click" Background="{StaticResource AccentBlue}" Foreground="White" Padding="12,10" Width="180" HorizontalAlignment="Left" FontSize="13" FontWeight="SemiBold"/>
                            </StackPanel>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="AnimalsDataGrid" ItemsSource="{Binding Animals}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Animal_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="120"/>
                                        <DataGridTextColumn Header="Breed" Binding="{Binding Breed}" Width="100"/>
                                        <DataGridTextColumn Header="Sex" Binding="{Binding Sex}" Width="70"/>
                                        <DataGridTextColumn Header="DOB" Binding="{Binding DOB, StringFormat=yyyy-MM-dd}" Width="100"/>
                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                        <DataGridTextColumn Header="Intake Date" Binding="{Binding IntakeDate, StringFormat=yyyy-MM-dd}" Width="110"/>
                                        <DataGridTextColumn Header="Group" Binding="{Binding GroupName}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Puppies View -->
                        <StackPanel x:Name="PuppiesView" Visibility="Collapsed">
                            <TextBlock Text="Puppies Management" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            
                            <!-- Puppies Statistics -->
                            <Grid Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" Background="{StaticResource DarkCardBackground}" CornerRadius="10" Padding="20" Margin="0,0,10,0" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                    <StackPanel>
                                        <TextBlock Text="Total Puppies" FontSize="12" Foreground="{StaticResource SecondaryText}" FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding TotalPuppies}" FontSize="32" FontWeight="Bold" Foreground="#FF6B9D" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Column="1" Background="{StaticResource DarkCardBackground}" CornerRadius="10" Padding="20" Margin="5,0,5,0" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                    <StackPanel>
                                        <TextBlock Text="Available for Adoption" FontSize="12" Foreground="{StaticResource SecondaryText}" FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding PuppiesAvailable}" FontSize="32" FontWeight="Bold" Foreground="{StaticResource AccentGreen}" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Column="2" Background="{StaticResource DarkCardBackground}" CornerRadius="10" Padding="20" Margin="10,0,0,0" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                    <StackPanel>
                                        <TextBlock Text="Puppies Adopted" FontSize="12" Foreground="{StaticResource SecondaryText}" FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding PuppiesAdopted}" FontSize="32" FontWeight="Bold" Foreground="{StaticResource AccentOrange}" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Grid>

                            <!-- Available Puppies -->
                            <TextBlock Text="Available Puppies" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,12" Foreground="{StaticResource PrimaryText}"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}" Margin="0,0,0,20">
                                <DataGrid Name="PuppiesAvailableDataGrid" ItemsSource="{Binding PuppiesAvailableForAdoption}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="300" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Animal_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="120"/>
                                        <DataGridTextColumn Header="Breed" Binding="{Binding Breed}" Width="100"/>
                                        <DataGridTextColumn Header="Sex" Binding="{Binding Sex}" Width="70"/>
                                        <DataGridTextColumn Header="DOB" Binding="{Binding DOB, StringFormat=yyyy-MM-dd}" Width="100"/>
                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                        <DataGridTextColumn Header="Group" Binding="{Binding GroupName}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>

                            <!-- Adopted Puppies -->
                            <TextBlock Text="Adopted Puppies" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,12" Foreground="{StaticResource PrimaryText}"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="PuppiesAdoptedDataGrid" ItemsSource="{Binding PuppiesAlreadyAdopted}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="300" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Animal_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="120"/>
                                        <DataGridTextColumn Header="Breed" Binding="{Binding Breed}" Width="100"/>
                                        <DataGridTextColumn Header="Sex" Binding="{Binding Sex}" Width="70"/>
                                        <DataGridTextColumn Header="DOB" Binding="{Binding DOB, StringFormat=yyyy-MM-dd}" Width="100"/>
                                        <DataGridTextColumn Header="Group" Binding="{Binding GroupName}" Width="100"/>
                                        <DataGridTextColumn Header="Adoption Date" Binding="{Binding AdoptionDate, StringFormat=yyyy-MM-dd}" Width="120"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- People View -->
                        <StackPanel x:Name="PeopleView" Visibility="Collapsed">
                            <TextBlock Text="People" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <Button Content="‚ûï Add New Person" Click="AddPerson_Click" Background="{StaticResource AccentBlue}" Foreground="White" Padding="12,10" Width="160" HorizontalAlignment="Left" Margin="0,0,0,18" FontSize="13" FontWeight="SemiBold"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="PeopleDataGrid" ItemsSource="{Binding People}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Person_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="200"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120"/>
                                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200"/>
                                        <DataGridTextColumn Header="Phone" Binding="{Binding Phone}" Width="130"/>
                                        <DataGridTextColumn Header="Address" Binding="{Binding Address}" Width="200"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Vet Visits View -->
                        <StackPanel x:Name="VetVisitsView" Visibility="Collapsed">
                            <TextBlock Text="Veterinary Visits" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <Button Content="‚ûï Add Vet Visit" Click="AddVetVisit_Click" Background="#E91E63" Foreground="White" Padding="12,10" Width="160" HorizontalAlignment="Left" Margin="0,0,0,18" FontSize="13" FontWeight="SemiBold"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="VetVisitsDataGrid" ItemsSource="{Binding VetVisits}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="VetVisit_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=yyyy-MM-dd}" Width="120"/>
                                        <DataGridTextColumn Header="Animal" Binding="{Binding Animal.Name}" Width="150"/>
                                        <DataGridTextColumn Header="Veterinarian" Binding="{Binding Person.Name}" Width="150"/>
                                        <DataGridTextColumn Header="Vaccinations" Binding="{Binding VaccinationsGiven}" Width="180"/>
                                        <DataGridTextColumn Header="Rabies Cost" Binding="{Binding RabiesShotCost, StringFormat=C}" Width="110"/>
                                        <DataGridTextColumn Header="Distemper Cost" Binding="{Binding DistemperCost, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="DAPP Cost" Binding="{Binding DAPPCost, StringFormat=C}" Width="100"/>
                                        <DataGridTextColumn Header="Worming Cost" Binding="{Binding WormingCost, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="DeFleeing Cost" Binding="{Binding DeFleeingCost, StringFormat=C}" Width="130"/>
                                        <DataGridTextColumn Header="Total Cost" Binding="{Binding TotalCost, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="Ready for Adoption" Binding="{Binding ReadyForAdoption}" Width="130"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Adoptions View -->
                        <StackPanel x:Name="AdoptionsView" Visibility="Collapsed">
                            <TextBlock Text="Adoptions" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <Button Content="‚ûï Record Adoption" Click="AddAdoption_Click" Background="#9C27B0" Foreground="White" Padding="12,10" Width="160" HorizontalAlignment="Left" Margin="0,0,0,18" FontSize="13" FontWeight="SemiBold"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="AdoptionsDataGrid" ItemsSource="{Binding Adoptions}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Adoption_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Animal" Binding="{Binding Animal.Name}" Width="150"/>
                                        <DataGridTextColumn Header="Adopter" Binding="{Binding Person.Name}" Width="150"/>
                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=yyyy-MM-dd}" Width="120"/>
                                        <DataGridTextColumn Header="Agreed Fee" Binding="{Binding AgreedFee, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="Paid Fee" Binding="{Binding PaidFee, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="Paid" Binding="{Binding Paid}" Width="70"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Intake View -->
                        <StackPanel x:Name="IntakeView" Visibility="Collapsed">
                            <TextBlock Text="Puppy Intake" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <Button Content="‚ûï Record Intake" Click="AddIntake_Click" Background="#00BCD4" Foreground="White" Padding="12,10" Width="160" HorizontalAlignment="Left" Margin="0,0,0,18" FontSize="13" FontWeight="SemiBold"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="IntakesDataGrid" ItemsSource="{Binding Intakes}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Intake_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=yyyy-MM-dd}" Width="120"/>
                                        <DataGridTextColumn Header="Number of Puppies" Binding="{Binding PuppyCount}" Width="140"/>
                                        <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="200"/>
                                        <DataGridTextColumn Header="Cost Per Puppy" Binding="{Binding CostPerPuppy, StringFormat=C}" Width="130"/>
                                        <DataGridTextColumn Header="Total Cost" Binding="{Binding TotalCost, StringFormat=C}" Width="120"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Expenses View -->
                        <StackPanel x:Name="ExpensesView" Visibility="Collapsed">
                            <TextBlock Text="Expenses" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <Button Content="‚ûï Add Expense" Click="AddExpense_Click" Background="#FF5722" Foreground="White" Padding="12,10" Width="160" HorizontalAlignment="Left" Margin="0,0,0,18" FontSize="13" FontWeight="SemiBold"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="ExpensesDataGrid" ItemsSource="{Binding Expenses}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Expense_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=yyyy-MM-dd}" Width="120"/>
                                        <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="120"/>
                                        <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=C}" Width="100"/>
                                        <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="300"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Income View -->
                        <StackPanel x:Name="IncomeView" Visibility="Collapsed">
                            <TextBlock Text="Income" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <Button Content="‚ûï Record Income" Click="AddIncome_Click" Background="#4CAF50" Foreground="White" Padding="12,10" Width="160" HorizontalAlignment="Left" Margin="0,0,0,18" FontSize="13" FontWeight="SemiBold"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="IncomesDataGrid" ItemsSource="{Binding Incomes}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="Income_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=yyyy-MM-dd}" Width="120"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="140"/>
                                        <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=C}" Width="100"/>
                                        <DataGridTextColumn Header="Group" Binding="{Binding GroupName}" Width="150"/>
                                        <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="250"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Money Owed View -->
                        <StackPanel x:Name="MoneyOwedView" Visibility="Collapsed">
                            <TextBlock Text="Money Owed" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                            <Button Content="‚ûï Add Money Owed" Click="AddMoneyOwed_Click" Background="#FFC107" Foreground="White" Padding="12,10" Width="180" HorizontalAlignment="Left" Margin="0,0,0,18" FontSize="13" FontWeight="SemiBold"/>
                            <Border Background="{StaticResource DarkCardBackground}" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" Effect="{StaticResource CardShadow}">
                                <DataGrid Name="MoneyOwedDataGrid" ItemsSource="{Binding MoneyOwed}" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="700" BorderThickness="0" Background="{StaticResource DarkCardBackground}" Foreground="{StaticResource PrimaryText}" MouseDoubleClick="MoneyOwed_DoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=yyyy-MM-dd}" Width="120"/>
                                        <DataGridTextColumn Header="Debtor" Binding="{Binding Debtor}" Width="150"/>
                                        <DataGridTextColumn Header="Reason" Binding="{Binding Reason}" Width="150"/>
                                        <DataGridTextColumn Header="Amount Owed" Binding="{Binding AmountOwed, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="Amount Paid" Binding="{Binding AmountPaid, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="Date Paid" Binding="{Binding DatePaid, StringFormat=yyyy-MM-dd}" Width="120"/>
                                        <DataGridTextColumn Header="Total Owed" Binding="{Binding TotalOwed, StringFormat=C}" Width="120"/>
                                        <DataGridTextColumn Header="Fully Paid" Binding="{Binding IsFullyPaid}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>

                        <!-- Reports View -->
                        <StackPanel x:Name="ReportsView" Visibility="Collapsed">
                            <TextBlock Text="Financial Reports" FontSize="{StaticResource LargeHeaderSize}" FontWeight="Bold" Margin="0,0,0,25" Foreground="{StaticResource PrimaryText}"/>
                            
                            <!-- Itemised Income Breakdown -->
                            <Border Background="{StaticResource DarkCardBackground}" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" CornerRadius="10" Padding="25" Margin="0,0,0,20" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <TextBlock Text="Itemised Income Breakdown" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="280"/>
                                            <ColumnDefinition Width="150"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Adoption Fees Paid (from Adoptions):" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding TotalAdoptionFees, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="1" Text="Adoption Fees Agreed (from Adoptions):" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding TotalAdoptionAgreedFees, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="2" Text="Unpaid Adoption Fees (Owed):" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding TotalUnpaidAdoptionFees, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#FFA726" Margin="10,8"/>
                                        <TextBlock Grid.Row="3" Text="Donations:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding TotalDonations, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="4" Text="Group Adoption Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding TotalGroupAdoptionIncome, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="5" Text="Adoption Fee Income (from Income):" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding TotalIncomeAdoptionFee, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="6" Text="Single Adoption Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding TotalSingleAdoptionIncome, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="7" Text="Grant Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding TotalGrantIncome, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="8" Text="Sponsorship Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="8" Grid.Column="1" Text="{Binding TotalSponsorshipIncome, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="9" Text="Fuel Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="9" Grid.Column="1" Text="{Binding TotalFuelIncome, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="10" Text="Cleaning Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="10" Grid.Column="1" Text="{Binding TotalCleaningIncome, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <TextBlock Grid.Row="11" Text="Other Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="11" Grid.Column="1" Text="{Binding TotalOtherIncome, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#66BB6A" Margin="10,8"/>
                                        <Rectangle Grid.Row="12" Grid.ColumnSpan="2" Height="1" Fill="{StaticResource DarkBorder}" Margin="0,10,0,5"/>
                                        <TextBlock Grid.Row="13" Text="TOTAL INCOME:" FontSize="14" FontWeight="Bold" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="13" Grid.Column="1" Text="{Binding TotalIncome, StringFormat=C}" FontSize="14" FontWeight="Bold" Foreground="#66BB6A" Margin="10,8"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Intake Costs Summary -->
                            <Border Background="{StaticResource DarkCardBackground}" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" CornerRadius="10" Padding="25" Margin="0,0,0,20" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <TextBlock Text="Intake Costs Summary" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="150"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Total Intake Cost:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding TotalIntakeCosts, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#EF5350" Margin="10,8"/>
                                        <TextBlock Grid.Row="1" Text="Total Puppies (Intake):" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding TotalIntakePuppies}" FontSize="13" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" Margin="10,8"/>
                                        <TextBlock Grid.Row="2" Text="Avg Cost Per Puppy:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding AverageIntakeCostPerPuppy, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" Margin="10,8"/>
                                        <TextBlock Grid.Row="3" Text="Avg Cost Per Litter:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding AverageIntakeCostPerLitter, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" Margin="10,8"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Itemised Expense Breakdown -->
                            <Border Background="{StaticResource DarkCardBackground}" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" CornerRadius="10" Padding="25" Margin="0,0,0,20" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <TextBlock Text="Itemised Expense Breakdown" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="280"/>
                                            <ColumnDefinition Width="150"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <!-- Veterinary Section from Vet Visits -->
                                        <TextBlock Text="Veterinary Costs (from Vet Visits):" FontSize="13" FontWeight="Bold" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding TotalVetCosts, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#EF5350" Margin="10,8"/>
                                        
                                        <TextBlock Grid.Row="1" Text="   ‚Ä¢ Worming:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding TotalWormingCosts, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="2" Text="   ‚Ä¢ De-fleying (Flea Treatment):" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding TotalDeFleeingCosts, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="3" Text="   ‚Ä¢ Dental:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding TotalDentalCosts, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="4" Text="   ‚Ä¢ Spayed/Neutering:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding TotalSpayedNeuteringCosts, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="5" Text="   ‚Ä¢ Rabies Shot:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding TotalRabiesShotCosts, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="6" Text="   ‚Ä¢ Distemper:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding TotalDistemperCosts, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="7" Text="   ‚Ä¢ DAPP:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding TotalDAPPCosts, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="8" Text="   ‚Ä¢ Total Visit Cost:" FontSize="12" Margin="15,4,0,8" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="8" Grid.Column="1" Text="{Binding TotalVisitCost, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4,10,8"/>
                                        
                                        <!-- Trip/Transport Costs -->
                                        <TextBlock Grid.Row="9" Text="Trip/Transport Costs (from Trips):" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="9" Grid.Column="1" Text="{Binding TotalTripCosts, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#EF5350" Margin="10,8"/>
                                        
                                        <!-- Intake Costs -->
                                        <TextBlock Grid.Row="10" Text="Intake Costs (from Intake):" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="10" Grid.Column="1" Text="{Binding TotalIntakeCosts, StringFormat=C}" FontSize="13" FontWeight="SemiBold" Foreground="#EF5350" Margin="10,8"/>
                                        
                                        <!-- Expenses Breakdown from Expenses Dialog -->
                                        <TextBlock Grid.Row="11" Text="All Expenses (from Expenses):" FontSize="13" FontWeight="Bold" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="11" Grid.Column="1" Text="{Binding TotalOtherExpenses, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#EF5350" Margin="10,8"/>
                                        
                                        <TextBlock Grid.Row="12" Text="   ‚Ä¢ Fuel:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="12" Grid.Column="1" Text="{Binding TotalFuelExpenses, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="13" Text="   ‚Ä¢ Tolls:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="13" Grid.Column="1" Text="{Binding TotalTollsExpenses, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="14" Text="   ‚Ä¢ Food:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="14" Grid.Column="1" Text="{Binding TotalFoodExpenses, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="15" Text="   ‚Ä¢ Laundry:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="15" Grid.Column="1" Text="{Binding TotalLaundryExpenses, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="16" Text="   ‚Ä¢ Supplies:" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="16" Grid.Column="1" Text="{Binding TotalSuppliesExpenses, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="17" Text="   ‚Ä¢ Veterinary (from Expenses):" FontSize="12" Margin="15,4,0,4" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="17" Grid.Column="1" Text="{Binding TotalVeterinaryExpenses, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4"/>
                                        
                                        <TextBlock Grid.Row="18" Text="   ‚Ä¢ Other Category:" FontSize="12" Margin="15,4,0,8" Foreground="{StaticResource SecondaryText}"/>
                                        <TextBlock Grid.Row="18" Grid.Column="1" Text="{Binding TotalOtherCategoryExpenses, StringFormat=C}" FontSize="12" Foreground="#EF5350" Margin="10,4,10,8"/>
                                        
                                        <Rectangle Grid.Row="19" Grid.ColumnSpan="2" Height="1" Fill="{StaticResource DarkBorder}" Margin="0,10,0,5"/>
                                        
                                        <TextBlock Grid.Row="20" Text="TOTAL EXPENSES:" FontSize="14" FontWeight="Bold" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="20" Grid.Column="1" Text="{Binding TotalExpenses, StringFormat=C}" FontSize="14" FontWeight="Bold" Foreground="#EF5350" Margin="10,8"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- Money Owed Summary -->
                            <Border Background="{StaticResource DarkCardBackground}" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" CornerRadius="10" Padding="25" Margin="0,0,0,20" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <TextBlock Text="Outstanding Money Owed" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="150"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Total Amount Owed:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding TotalMoneyOwedAmount, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#FFC107" Margin="10,8"/>
                                        <TextBlock Grid.Row="1" Text="Total Amount Paid:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding TotalMoneyPaid, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#4CAF50" Margin="10,8"/>
                                        <TextBlock Grid.Row="2" Text="Outstanding Balance:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding TotalMoneyOwed, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#FFC107" Margin="10,8"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Profit Summary -->
                            <Border Background="{StaticResource DarkCardBackground}" BorderThickness="1" BorderBrush="{StaticResource DarkBorder}" CornerRadius="10" Padding="25" Margin="0,0,0,20" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <TextBlock Text="Profit Summary" FontSize="{StaticResource HeaderSize}" FontWeight="Bold" Margin="0,0,0,18" Foreground="{StaticResource PrimaryText}"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="150"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="Monthly Profit/Loss:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding MonthlyProfit, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" Margin="10,8"/>

                                        <TextBlock Grid.Row="1" Text="Monthly Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding TotalIncome, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#4CAF50" Margin="10,8"/>

                                        <TextBlock Grid.Row="2" Text="Monthly Expenses:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding TotalExpenses, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="{StaticResource AccentRed}" Margin="10,8"/>

                                        <TextBlock Grid.Row="3" Text="Yearly Income:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding YearlyIncome, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="#4CAF50" Margin="10,8"/>

                                        <TextBlock Grid.Row="4" Text="Yearly Expenses:" FontSize="13" Margin="0,8" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding YearlyExpenses, StringFormat=C}" FontSize="13" FontWeight="Bold" Foreground="{StaticResource AccentRed}" Margin="10,8"/>

                                        <TextBlock Grid.Row="5" Text="Yearly Profit/Loss:" FontSize="14" FontWeight="Bold" Margin="0,12" Foreground="{StaticResource PrimaryText}"/>
                                        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding YearlyProfit, StringFormat=C}" FontSize="14" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" Margin="10,12"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <TextBlock Text="{Binding StatusMessage}" FontSize="12" Foreground="{StaticResource SecondaryText}" Margin="0,25,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DockPanel>
</Window>
